---
title: "Airline Delay Prediction Report"
author: "Logistics Transport Aviation"
date: "30/08/2021"
output:
  word_document:
    toc: yes
    toc_depth: '3'
  pdf_document:
    toc: yes
    toc_depth: '3'
  html_document:
    toc: yes
    toc_float: yes
    toc_depth: 3
    fig_caption: yes
subtitle: STDS - AT2
---
  
```{r setup, include=FALSE}
## knitr::opts_chunk$set(echo = TRUE)
## install.packages("kableExtra")
library(tidyverse)
library(kableExtra)
```

## Introduction

Aircraft delays have serious economic impacts that represent a logistical headache for airlines, airports, airline crew, and passengers alike. In a 2010 study by the National Center of Excellence For Aviation Operations Research, an estimated 31.2 billion US dollars was lost due to direct and indirect costs of airline delays in the United States for 2007. These expenses included maintenance costs, extra paid hours for flight crew, the extra use of fuel, and airport fees. As an example, airlines have dedicated time slots at airport gates and unexpected delays exceeding the expected time slot can cost thousands of dollars by the minute.

Many factors can contribute to aircraft delays. These may include unavoidable reasons such as inclement weather, unforeseen aircraft mechanical breakdowns, or a multitude of passenger-related incidents. Airline delays then create complicated scenarios for airline schedulers as a delay for one aircraft may impact the flight schedule for all consecutive flights using that aircraft. Passengers with connecting flights may need to be ticketed on other flights, reserve flight crew may need to be called if the current flight crew are going to exceed their flight hours, and delays may continue to have a snowball effect on later flights causing them to also be delayed (Ball, 2010).

Thus, understanding the impact of these variables on aircraft on-time performance can help elucidate ways and methods to mitigate these airline delays. By doing so, steps can be made to reduce airline costs associated with these delays, benefiting the airlines' stakeholders. We identify the primary stakeholders to be investors and shareholders for the financial performance of the airline. In addition, airline passengers are important stakeholders as delays negatively influence repurchase intentions and sentiment across word-of-mouth (Kim, 2016).

Herein, we propose an exploratory analysis and prediction model on airline delays utilizing data from the United States in 2019.

Good features for the Introduction include:
• Summary of the study and data, as well as any relevant substantive context, background, or
framing issues.
• The “big questions” answered by your data analyses, and summaries of your conclusions about
these questions.
• Brief outline of remainder of paper.
The above is a pretty good order to present this material in as well.


## Body

```{r stakeholder_analysis, echo=FALSE}
text_tbl <- data.frame(
  Stakeholders = c("Airline company executives", "Airline company employees", "Shareholders and investors of Airline companies", "Consumers of airline companies", "Suppliers for Airline companies", "Government"),
  Description = c(
    "The main participants in the aviation industry. 
This project can help them improve their operational planning and execution and any related products and services. ",
    "Pilots, engineers, and flight attendants ensure that passengers' needs are appropriately met and satisfied.  ", 
    "Their primary role is to provide capital in the form of share capital. Airlines performance may affect their investing behaviours. ", "Airline company/industry’s primary revenue source. Customers are the most important factor in this industry; without customers, airlines would not exist. ", "Form in which how much the company orders supplies in impacts inventory, e.g Aircraft manufacters, fuel and food/beverage resources. ", "Government and policy makers can impact how the industry will be regulated, such as climate change, tourism, and infrastructure policy.  "
  )
)

kbl(text_tbl) %>%
  kable_paper(full_width = F) %>%
  column_spec(1, bold = T, border_right = T) %>%
  column_spec(2, width = "30em")
```

The body can be organized in several ways. Here are two that often work well:
• Traditional. Divide the body up into several sections at the same level as the Introduction, with
names like:
– Data
– Methods
– Analysis
– Results
This format is very familiar to those who have written psych research papers. It often works
well for a data analysis paper as well, though one problem with it is that the Methods section
often sounds like a bit of a stretch: In a psych research paper the Methods section describes
what you did to get your data. In a data analysis paper, you should describe the analyses that
you performed. Without the results as well, this can be pretty sterile sounding, so I often merge
these “methods” pieces into the “Analysis” section when I write.
• Question-oriented. In this format there is a single Body section, usually called “Analysis”,
and then there is a subsection for each question raised in the introduction, usually taken in the
same order as in the introduction (general to specific, decreasing order of importance, etc.).
Within each subsection, statistical method, analyses, and conclusion would be described (for
each question). For example:
2. Analysis
2.1 Success Rate
Methods
Analysis
Conclusions
2.2 Time to Relapse
Methods
Analysis
Conclusions
3
2.3 Effect of Gender
Methods
Analysis
Conclusions
2.4 Hospital Effects
Methods
Analysis
Conclusions
Etc. . .
Other organizational formats are possible too. Whatever the format, it is useful to provide one or two
well-chosen tables or graphs per question in the body of the report, for two reasons: First, graphical
and tabular displays can convey your points more efficiently than words; and second, your “skimming”
audiences will be more likely to have their eye caught by an interesting graph or table than by running
text. However, too much graphical/tabular material will break up the flow of the text and become
distracting; so extras should be moved to the Appendix.


## Conclusion

As the airline network contains complex interactions between regulatory, passenger, and airline-specific needs, predicting delays and understanding the primary causes is relatably complicated. 

Our main question to answer is: **Which factors are most correlated to, and influence greatly, on-time aircraft performance?**. 

From here, smaller questions can be asked such as: Are delays impacted by weather, date, time of day, route, aircraft type, or economic category?

The conclusion should reprise the questions and conclusions of the introduction, perhaps augmented by some additional observations or details gleaned from the analysis
section. New questions, future work, etc., can also be raised here.


## References

Ball, M. (2010, November). Total Delay Impact Study A Comprehensive Assessment of the Costs and Impacts of Flight Delay in the United States. https://isr.umd.edu/NEXTOR/pubs/TDI_Report_Final_11_03_10.pdf

Kim, N. Y., & Park, J. W. (2016). A study on the impact of airline service delays on emotional reactions and customer behavior. Journal of Air Transport Management, 57, 19–25. https://doi.org/10.1016/j.jairtraman.2016.07.005


## Appendix

```{r add_packages, message=FALSE, warning=FALSE}
  library(psych)
  library(devtools)

  library(tidyverse)
  library(dplyr)
  library(ggplot2)
  library(Amelia)

  library(knitr)
```


To get the latest content, we are using a web API call for Airport Names. The `httr::get` will assist us in fetching the content in the JSON format. API key is being used for authenticating our call with the API provider. Since JSON cannot be directly consumed by regression packages, we deploy `jsonlite::fromJSON` to convert to an R dataframe.

```{r, message=FALSE, warning=FALSE}
library(httr)
library(jsonlite)
library(dplyr)

icao <- GET(
  url = 'https://applications.icao.int/dataservices/api/safety-characteristics-list?api_key=8d00ef90-0982-11ec-9d72-8160549d64ab&airports=&states=USA'
)
response <- content(icao, 'parsed')
API_data <- fromJSON(response)

#Only pick those columns that are useful later on 
API_data <- API_data %>% select(airportCode, airportName)
```
Airline On-time data 
```{r, message=FALSE, warning=FALSE}
ontime_raw <- read.csv("https://raw.githubusercontent.com/charlottetse33/36103_Logistics-Transport-Aviation/main/test%20on%20time%20report.csv")
```
Airline DOT_ID corresponding to Airline Names
```{r, message=FALSE, warning=FALSE}
#Seperate loading data to prevent R from crashing
id_airline <- read.csv("https://raw.githubusercontent.com/charlottetse33/36103_Logistics-Transport-Aviation/main/dot_id_airline.csv")

```
Merge Airline Names with On-time Dataset 
```{r, message=FALSE, warning=FALSE}
colnames(id_airline) <- c("DOT_ID_Reporting_Airline", "Airline")
  
ontime_1 <- left_join(ontime_raw, id_airline, by = "DOT_ID_Reporting_Airline")

```
Merge API Airport names with On-time Dataset 
```{r, message=FALSE, warning=FALSE}
ontime_2 <- ontime_1 %>% mutate(Origin_airportCode = paste("K",Origin, sep = ""), Dest_airportCode = paste("K",Dest, sep = ""))

Originjoint <- left_join(ontime_2, API_data, by = c("Origin_airportCode" = "airportCode"))
names(Originjoint)[names(Originjoint) == "airportName"] <- "Origin_airportName"

ontime_final <- left_join(Originjoint, API_data, by = c("Dest_airportCode" = "airportCode"))
names(ontime_final)[names(ontime_final) == "airportName"] <- "Dest_airportName"

#New column names from merging data: 
#Airline, Origin_airportName, Dest_airportName

```

One or more appendices are the place to out details and ancillary materials.
These might include such items as
• Technical descriptions of (unusual) statistical procedures
• Detailed tables or computer output
• Figures that were not central to the arguments presented in the body of the report
• Computer code used to obtain results.
In all cases, and especially in the case of computer code, it is a good idea to add some text sentences
as comments or annotations, to make it easier for the uninitiated reader to follow what you are doing.
It is often difficult to find the right balance between what to put in the appendix and what to put in
the body of the paper. Generally you should put just enough in the body to make the point, and refer
the reader to specific sections or page numbers in the appendix for additional graphs, tables and other
details.